!function(e,t,r){"use strict";var o="/api",s="authorization",i=t.module("lbServices",["ngResource"]);i.factory("School",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Schools/:id",{id:"@id"},{find:{url:o+"/Schools",params:{filter:{fields:["name"]}},method:"GET",isArray:!0},findOne:{url:o+"/Schools",method:"GET",isArray:!0}});return s.modelName="School",s}]),i.factory("Aouth",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Aouths/:id",{id:"@id"},{findById:{url:o+"/Aouths/:id",method:"GET"},deleteById:{url:o+"/Aouths/:id",method:"DELETE"}});return s.modelName="Aouth",s}]),i.factory("User",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/WUsers/:id",{id:"@id"},{prototype_create_replys:{url:o+"/WUsers/:id/replys",method:"POST"},prototype_create_comments:{url:o+"/WUsers/:id/comments",method:"POST"},prototype_create_articles:{url:o+"/WUsers/:id/articles",method:"POST"},prototype_create_likeUsers:{url:o+"/WUsers/:id/likeUsers",method:"POST"},auth2wechat:{url:o+"/WUsers/auth2wechat",method:"GET"},checkPhone:{url:o+"/WUsers/:id/checkPhone",method:"GET"},updateAll:{url:o+"/WUsers/updateAll",method:"GET"},prototype_create_coteries:{url:o+"/WUsers/:id/coteries",method:"POST"},prototype_updateById_coteries:{url:o+"/WUsers/:id/coteries/:fk",params:{fk:"@fk"},method:"PUT"},prototype_get_teams:{url:o+"/WUsers/:id/teams",method:"GET",isArray:!0},prototype_get_articles:{url:o+"/WUsers/:id/articles",method:"GET",isArray:!0},prototype_get_coteries:{url:o+"/WUsers/:id/coteries",method:"GET",isArray:!0},create:{url:o+"/WUsers",method:"POST"},confirmSchool:{url:o+"/WUsers/:id/confirmSchool",method:"POST"},prototype_create_formResults:{url:o+"/WUsers/:id/formResults",method:"POST"},prototype_findById_formResults:{url:o+"/WUsers/:id/formResults/:fk",params:{fk:"@fk"},method:"GET"},prototype_create_voteResults:{url:o+"/WUsers/:id/voteResults",method:"POST"},prototype_findById_voteResults:{url:o+"/WUsers/:id/voteResults/:fk",params:{fk:"@fk"},method:"GET"},prototype_create_seckillResults:{url:o+"/WUsers/:id/seckillResults",method:"POST"},prototype_findById_seckillResults:{url:o+"/WUsers/:id/seckillResults/:fk",params:{fk:"@fk"},method:"GET"},getMyTeams:{url:o+"/WUsers/:id/myTeams",method:"GET"},getInfo:{url:o+"/WUsers/info",method:"GET"},getActivitiesHistories:{url:o+"/WUsers/:id/activitiesHistories",method:"GET"},getRaceHistories:{url:o+"/WUsers/:id/raceHistories",method:"GET"},getLikeArticles:{url:o+"/WUsers/:id/likeArticles",method:"GET"},prototype_updateAttributes:{url:o+"/WUsers/:id",method:"PUT"},prototype_create_teams:{url:o+"/WUsers/:id/teams",method:"POST"},resetPassword:{url:o+"/WUsers/reset",method:"POST"},prototype_updateById_teams:{url:o+"/WUsers/:id/teams/:fk",params:{fk:"@fk"},method:"PUT"},login:{url:o+"/WUsers/login",method:"POST",params:{include:"user"},interceptor:{response:function(e){var r=e.data;return t.setUser(r.id,r.userId,r.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}}}});return s}]).factory("Team",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Teams/:id",{id:"@id"},{find:{url:o+"/Teams",method:"GET",isArray:!0},prototype_link_partakedRaces:{url:o+"/Teams/:id/partakedRaces/rel/:fk",params:{fk:"@fk"},method:"PUT"},prototype_get_partakedRaces:{url:o+"/Teams/:id/partakedRaces",method:"GET",isArray:!0},prototype_unlink_partakedRaces:{url:o+"/Teams/:id/partakedRaces/rel/:fk",method:"DELETE"},getMySchoolTeams:{url:o+"/Teams/mySchoolTeams",method:"GET"},findById:{url:o+"/Teams/:id",method:"GET"},prototype_updateAttributes:{url:o+"/Teams/:id",method:"PUT"},prototype_get_activities:{url:o+"/Teams/:id/activities",method:"GET",isArray:!0},prototype_create_activities:{url:o+"/Teams/:id/activities",method:"POST"},prototype_create_forms:{url:o+"/Teams/:id/forms",method:"POST"},prototype_findById_forms:{url:o+"/Teams/:id/forms/:fk",method:"GET"},prototype_updateById_forms:{url:o+"/Teams/:id/forms/:fk",method:"PUT"},prototype_create_votes:{url:o+"/Teams/:id/votes",method:"POST"},prototype_findById_votes:{url:o+"/Teams/:id/votes/:fk",method:"GET"},prototype_updateById_votes:{url:o+"/Teams/:id/votes/:fk",method:"PUT"},prototype_create_seckills:{url:o+"/Teams/:id/seckills",method:"POST"},prototype_findById_seckills:{url:o+"/Teams/:id/seckills/:fk",method:"GET"},prototype_updateById_seckills:{url:o+"/Teams/:id/seckills/:fk",method:"PUT"},prototype_get_seckills:{url:o+"/Teams/:id/seckills",method:"GET",isArray:!0},prototype_destroyById_seckills:{url:o+"/Teams/:id/seckills/:fk",method:"DELETE"},prototype_get_forms:{url:o+"/Teams/:id/forms",method:"GET",isArray:!0},prototype_destroyById_forms:{url:o+"/Teams/:id/forms/:fk",method:"DELETE"},prototype_get_votes:{url:o+"/Teams/:id/votes",method:"GET",isArray:!0},prototype_destroyById_votes:{url:o+"/Teams/:id/votes/:fk",method:"DELETE"},prototype_updateById_activities:{url:o+"/Teams/:id/activities/:fk",method:"PUT"},prototype_findById_activities:{url:o+"/Teams/:id/activities/:fk",method:"GET"},prototype_create_members:{url:o+"/Teams/:id/members",method:"POST"},prototype_get_members:{url:o+"/Teams/:id/members",method:"GET",isArray:!0},prototype_findById_members:{url:o+"/Teams/:id/members/:fk",params:{fk:"@fk"},method:"GET"},prototype_destroyById_members:{url:o+"/Teams/:id/members/:fk",params:{fk:"@fk"},method:"DELETE"},prototype_updateById_members:{url:o+"/Teams/:id/members/:fk",params:{fk:"@fk"},method:"PUT"},prototype_create_departments:{url:o+"/Teams/:id/departments",method:"POST"},prototype_destroyById_departments:{url:o+"/Teams/:id/departments/:fk",params:{fk:"@fk"},method:"DELETE"},prototype_get_races:{url:o+"/Teams/:id/races",method:"GET",isArray:!0},prototype_create_races:{url:o+"/Teams/:id/races",method:"POST"},prototype_updateById_races:{url:o+"/Teams/:id/races/:fk",method:"PUT"},prototype_findById_races:{url:o+"/Teams/:id/races/:fk",method:"GET"}});return s}]).factory("Article",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Articles/:id",{id:"@id"},{findById:{url:o+"/Articles/:id",method:"GET"},prototype_get_comments:{url:o+"/Articles/:id/comments",method:"GET",isArray:!0},prototype_create_readers:{url:o+"/Articles/:id/readers",method:"POST"}});return s}]).factory("Comment",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Comments/:id",{id:"@id"},{prototype_get_replys:{url:o+"/Comments/:id/replys",method:"GET",isArray:!0}});return s}]).factory("Notice",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Notices/:id",{id:"@id"},{prototype_create_form:{url:o+"/Notices/:id/form",method:"POST"}});return s}]).factory("Coterie",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Coteries/:id",{id:"@id"},{prototype_count_fans:{url:o+"/Coteries/:id/fans/count",method:"GET"},find:{url:o+"/Coteries",method:"GET",isArray:!0},prototype_get_articles:{url:o+"/Coteries/:id/articles",method:"GET",isArray:!0},prototype_findById_articles:{url:o+"/Coteries/:id/articles/:fk",params:{fk:"@fk"},method:"GET"},findById:{url:o+"/Coteries/:id",method:"GET"}});return s}]).factory("Activity",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Activities/:id",{id:"@id"},{getHotActiveties:{url:o+"/Activities/hotActiveties",method:"GET",isArray:!0},find:{url:o+"/Activities",method:"GET",isArray:!0},prototype_get_forms:{url:o+"/Activities/:id/forms",method:"GET",isArray:!0},prototype_get_votes:{url:o+"/Activities/:id/votes",method:"GET",isArray:!0},prototype_updateById_votes:{url:o+"/Activities/:id/votes/:fk",method:"PUT"},prototype_updateById_seckills:{url:o+"/Activities/:id/seckills/:fk",method:"PUT"},prototype_get_seckills:{url:o+"/Activities/:id/seckills",method:"GET",isArray:!0},prototype_create_forms:{url:o+"/Activities/:id/forms",method:"POST"},prototype_create_votes:{url:o+"/Activities/:id/votes",method:"POST"},prototype_create_seckills:{url:o+"/Activities/:id/seckills",method:"POST"},prototype_updateById_forms:{url:o+"/Activities/:id/forms/:fk",method:"PUT"},prototype_delete_forms:{url:o+"/Activities/:id/forms",method:"DELETE"},prototype_delete_votes:{url:o+"/Activities/:id/votes",method:"DELETE"},prototype_delete_seckills:{url:o+"/Activities/:id/seckills",method:"DELETE"},getMySchoolActiveties:{url:o+"/Activities/mySchoolActiveties",method:"GET"},search:{url:o+"/Activities/search",method:"GET",isArray:!0},prototype_create_readers:{url:o+"/Activities/:id/readers",method:"POST"},findById:{url:o+"/Activities/:id",method:"GET"}});return s}]).factory("Seckill",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Seckills/:id",{id:"@id"},{prototype_get_seckillResults:{url:o+"/Seckills/:id/seckillResults",method:"GET",isArray:!0}});return s}]).factory("Form",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Forms/:id",{id:"@id"},{prototype_get_formResults:{url:o+"/Forms/:id/formResults",method:"GET",isArray:!0},excel:{url:o+"/Forms/:id/excel",method:"GET"}});return s}]).factory("Vote",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Votes/:id",{id:"@id"},{prototype_get_voteResults:{url:o+"/Votes/:id/voteResults",method:"GET",isArray:!0}});return s}]).factory("Race",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var s=e(o+"/Races/:id",{id:"@id"},{find:{url:o+"/Races",method:"GET",isArray:!0},getMySchoolRaces:{url:o+"/Races/mySchoolRaces",method:"GET"},findById:{url:o+"/Races/:id",method:"GET"},prototype_get_notices:{url:o+"/Races/:id/notices",method:"GET",params:{filter:{order:"id DESC",include:"form",where:{deleted:!1}}},isArray:!0},prototype_create_notices:{url:o+"/Races/:id/notices",method:"POST"},prototype_updateById_notices:{url:o+"/Races/:id/notices/:fk",method:"PUT"},prototype_get_raceTeams:{url:o+"/Races/:id/raceTeams",params:{filter:{fields:["id","name","logoUrl","status","desc"],include:{relation:"members",scope:{fields:["name","academy","userId","department","phone"]}}}},method:"GET",isArray:!0},prototype_unlink_raceTeams:{url:o+"/Races/:id/raceTeams/rel/:fk",method:"DELETE"},prototype_get_materials:{url:o+"/Races/:id/materials",method:"GET",isArray:!0},prototype_updateById_materials:{url:o+"/Races/:id/materials/:fk",method:"PUT"},prototype_destroyById_materials:{url:o+"/Races/:id/materials/:fk",method:"DELETE"},prototype_create_materials:{url:o+"/Races/:id/materials",method:"POST"}});return s}]).factory("LoopBackAuth",function(){function e(){var e=this;s.forEach(function(t){e[t]=o(t)}),this.rememberMe=r,this.currentUserData=null}function t(e,t,r){var o=i+t;null==r&&(r=""),e[o]=r}function o(e){var t=i+e;return localStorage[t]||sessionStorage[t]||null}var s=["accessTokenId","currentUserId"],i="$LoopBack$";return e.prototype.save=function(){var e=this,r=this.rememberMe?localStorage:sessionStorage;s.forEach(function(o){t(r,o,e[o])})},e.prototype.setUser=function(e,t,r){this.accessTokenId=e,this.currentUserId=t,this.currentUserData=r},e.prototype.clearUser=function(){this.accessTokenId=null,this.currentUserId=null,this.currentUserData=null},e.prototype.clearStorage=function(){s.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e}).config(["$httpProvider",function(e){e.interceptors.push("LoopBackAuthRequestInterceptor")}]).factory("LoopBackAuthRequestInterceptor",["$q","$rootScope","LoopBackAuth",function(e,t,i){return{request:function(t){if(t.url.substr(0,o.length)!==o)return t;if(i.accessTokenId)t.params=t.params||{},t.params.access_token=i.accessTokenId,t.headers[s]=i.accessTokenId;else if(t.__isGetCurrentUser__){var a={body:{error:{status:401}},status:401,config:t,headers:function(){return r}};return e.reject(a)}return t||e.when(t)},responseError:function(r){switch(r.status){case 401:"/api/WUsers/login"!==r.config.url&&t.$broadcast("auth:loginRequired");break;case 500:t.$broadcast("error:unknown",r)}return e.reject(r)}}}]).provider("LoopBackResource",function(){this.setAuthHeader=function(e){s=e},this.setUrlBase=function(e){o=e},this.getUrlBase=function(){return o},this.$get=["$resource",function(e){return function(t,r,o){var s=e(t,r,o);return s.prototype.$save=function(e,t){var r=s.upsert.call(this,{},this,e,t);return r.$promise||r},s}}]})}(window,window.angular);
!function(e){e.module("ue.config",[]).factory("Ueditor",["$rootScope",function(e){function r(){if(e.teamInfo)var r="team",t=e.teamInfo.id;else{if(!e.$currentUser)return;var r="user",t=e.$currentUser.id}var i="/ue/uploads?dir="+r+"&id="+t;return{serverUrl:i,toolbars:[["fullscreen","source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","|","justifyleft","justifycenter","justifyright","justifyjustify","|","simpleupload","insertimage","attachment","insertvideo","music"]],initialFrameHeight:300,wordCount:!1,elementPathEnabled:!1,enableContextMenu:!1}}return{config:r()}}])}(window.angular);
!function(t){var e=t.module("ng.upload",[]);e.factory("uploadFile",["$http",function(e){return{file:function(a,n,o){var d=new FormData,i="/ue/uploads?dir="+n+"&id="+o+"&action=uploadfile";return d.append("file",a),e({url:i,data:d,method:"POST",headers:{"Content-Type":void 0},transformRequest:t.identity})},text:function(t,a,n){return e({url:"/ue/uploads?dir="+a+"&id="+n+"&action=uploadtext",method:"post",data:{content:t}})},img:function(a,n,o){var d=new FormData,i="/ue/uploads?dir="+n+"&id="+o+"&action=uploadimage";return d.append("file",a),e({url:i,data:d,method:"POST",headers:{"Content-Type":void 0},transformRequest:t.identity})}}}])}(window.angular);